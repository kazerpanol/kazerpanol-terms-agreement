<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice-Controlled Slider</title>
<style>
  body { font-family: sans-serif; text-align: center; padding: 50px; }
  #slider { width: 80%; margin: 30px 0; }
  button { padding: 10px 20px; font-size: 16px; margin: 5px; }
  #savedValue { font-weight: bold; color: green; margin-top: 15px; }
</style>
</head>
<body>

<h1>Voice-Controlled Slider</h1>
<input type="range" id="slider" min="0" max="100" value="50">
<p>Slider value: <span id="value">50</span>%</p>

<button id="startBtn">Start Listening</button>
<button id="saveBtn">Save Value</button>

<p id="savedValue"></p>

<script>
let audioContext;
let analyser;
let microphone;
let dataArray;
let slider = document.getElementById('slider');
let valueDisplay = document.getElementById('value');
let savedDisplay = document.getElementById('savedValue');
let running = false;

async function startListening() {
    if (running) return;
    running = true;

    audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    microphone = audioContext.createMediaStreamSource(stream);

    analyser = audioContext.createAnalyser();
    analyser.fftSize = 256;
    const bufferLength = analyser.frequencyBinCount;
    dataArray = new Uint8Array(bufferLength);

    microphone.connect(analyser);

    function updateSlider() {
        analyser.getByteTimeDomainData(dataArray);
        let sum = 0;
        for(let i=0; i<dataArray.length; i++){
            let val = (dataArray[i] - 128)/128;
            sum += val * val;
        }
        let rms = Math.sqrt(sum / dataArray.length);
        let sliderValue = Math.min(100, Math.max(0, Math.floor(rms * 500)));
        slider.value = sliderValue;
        valueDisplay.textContent = sliderValue;

        requestAnimationFrame(updateSlider);
    }

    updateSlider();
}

document.getElementById('startBtn').addEventListener('click', startListening);

document.getElementById('saveBtn').addEventListener('click', () => {
    let savedValue = slider.value;
    savedDisplay.textContent = `Saved value: ${savedValue}% âœ…`;
});
</script>

</body>
</html>
